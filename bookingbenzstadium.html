<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Booking</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <!-- PHP ➜ HTML -->
    <link rel="stylesheet" href="booking.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">

</head>

<body>

<header class="custom-header">
    <div class="header-row">
        <!-- PHP ➜ HTML -->
        <a href="kategoribadminton.html" class="back-button">
            <i class="fas fa-arrow-left"></i> Kembali
        </a>

        <h1 class="header-title">BENZ STADIUM</h1>
        <div class="header-spacer"></div>
    </div>
</header>

<main class="main-content-container">
    <div class="row">
        <div class="col-lg-6 col-md-12 hero-image-col">
            <!-- PHP ➜ HTML -->
            <img src="Benz Stadium.jpg" alt="Lapangan Basket The Bucketlist Bogor" class="img-fluid">
        </div>

        <div class="col-lg-6 col-md-12 facilities">
            <h3 class="section-title">Fasilitas</h3>

            <div class="fasilitas-container d-flex justify-content-start flex-wrap">
                <ul class="fas-satu me-4">
                    <li>Coffee & Resto</li>
                    <li>Parkir Mobil & Motor</li>
                    <li>Ruang Ganti</li>
                </ul>
                <ul class="fas-dua">
                    <li>Mushola</li>
                    <li>Toilet</li>
                    <li>Wifi</li>
                </ul>
            </div>

            <div class="price">Rp 45.000<span>/Sesi</span></div>

            <div class="schedule-section mt-4">
                <h3 class="section-title">Pilih Jadwal</h3>

                <div class="days d-flex flex-wrap gap-2 mb-3">
                    <button class="btn day-button">Senin</button>
                    <button class="btn day-button">Selasa</button>
                    <button class="btn day-button">Rabu</button>
                    <button class="btn day-button">Kamis</button>
                    <button class="btn day-button">Jumat</button>
                    <button class="btn day-button">Sabtu</button>
                    <button class="btn day-button">Minggu</button>
                </div>

                <div class="schedule d-flex flex-wrap gap-2">
                    <button class="btn time-button">60 menit 08:00–09:00</button>
                    <button class="btn time-button">60 menit 09:00–10:00</button>
                    <button class="btn time-button">60 menit 10:00–11:00</button>
                </div>

                <div class="booking-button-wrapper">
                    <a href="javascript:void(0);" class="booking-button" id="mainBookingButton">
                        Booking Sekarang
                    </a>
                </div>
            </div>
        </div>
    </div>
</main>

<div class="description">
    <h3 class="section-title">Benz Stadium</h3>
    <p>Benstadium merupakan lapangan olahraga Badminton dan Hybrid Futsal-Basketball yang berlokasi di Kota Bogor sejak 2011</p>
</div>

<div class="location">
    <h3 class="section-title">Lokasi Venue</h3>
    <p>Jl. Jagung No.89, RT.05/RW.09, Baranangsiang, Kec. Bogor Tim., Kota Bogor, Jawa Barat 16143</p>
    <a href="https://maps.app.goo.gl/ayPhRuZE6h3cSbjdA" class="map-button">Buka Peta</a>
</div>

<footer class="footer">
    <!-- TIDAK DIUBAH -->
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const dayButtons = document.querySelectorAll('.day-button');
            const timeButtons = document.querySelectorAll('.time-button');
            const mainBookingButton = document.getElementById('mainBookingButton');
            
            let selectedDayButton = null;
            let selectedTimeButton = null;

            // Fungsi untuk memeriksa apakah tombol booking harus diaktifkan
            function checkBookingReadiness() {
                if (selectedDayButton && selectedTimeButton) {
                    mainBookingButton.removeAttribute('disabled');
                } else {
                    mainBookingButton.setAttribute('disabled', 'true');
                }
            }

            // Fungsi untuk menangani klik tombol hari
            dayButtons.forEach(button => {
                button.addEventListener('click', function() {
                    // Jika ada hari yang sebelumnya dipilih, batalkan pemesanannya
                    if (selectedDayButton) {
                        selectedDayButton.classList.remove('booked');
                        selectedDayButton.removeAttribute('disabled');
                    }
                    
                    // Tandai tombol hari saat ini sebagai terpilih
                    this.classList.add('booked');
                    this.setAttribute('disabled', 'true'); // Ini akan membuat tombol "tidak dapat diklik"
                    selectedDayButton = this;

                    // Opsional: Atur ulang pemilihan waktu saat hari baru dipilih
                    if (selectedTimeButton) {
                        selectedTimeButton.classList.remove('booked');
                        selectedTimeButton.removeAttribute('disabled');
                        selectedTimeButton = null;
                    }
                    checkBookingReadiness(); // Periksa kembali status tombol booking
                    fetchAndDisableBookedSlots(this.textContent); // Fetch and disable slots for the selected day
                });
            });

            // Fungsi untuk menangani klik tombol waktu
            timeButtons.forEach(button => {
                button.addEventListener('click', function() {
                    // Jika ada waktu yang sebelumnya dipilih, batalkan pemesanannya
                    if (selectedTimeButton) {
                        selectedTimeButton.classList.remove('booked');
                        selectedTimeButton.removeAttribute('disabled');
                    }
                    
                    // Tandai tombol waktu saat ini sebagai terpilih
                    this.classList.add('booked');
                    this.setAttribute('disabled', 'true'); // Ini akan membuat tombol "tidak dapat diklik"
                    selectedTimeButton = this;
                    checkBookingReadiness(); // Periksa kembali status tombol booking
                });
            });

            // Tambahkan event listener untuk tombol Booking Sekarang (opsional, untuk tindakan nyata)
            mainBookingButton.addEventListener('click', function() {
                if (selectedDayButton && selectedTimeButton) {
                    const dayName = selectedDayButton.textContent;
                    const time = selectedTimeButton.textContent;
                    const venue = document.querySelector('.header-title').textContent;

                    // Calculate the actual date based on the selected day name
                    const today = new Date();
                    const dayIndex = ['Minggu', 'Senin', 'Selasa', 'Rabu', 'Kamis', 'Jumat', 'Sabtu'].indexOf(dayName);
                    const selectedDate = new Date(today);
                    selectedDate.setDate(today.getDate() + (dayIndex + 7 - today.getDay()) % 7);
                    const formattedDate = selectedDate.toISOString().split('T')[0]; // YYYY-MM-DD
                    
                    // Construct the URL with query parameters
                    const url = `<?= base_url('payment') ?>?venue=${encodeURIComponent(venue)}&day=${encodeURIComponent(formattedDate)}&time=${encodeURIComponent(time)}`;
                    
                    // Redirect to the payment page
                    window.location.href = url;
                } else {
                    alert('Mohon pilih hari dan waktu terlebih dahulu.');
                }
            });

            checkBookingReadiness(); // Panggil saat halaman dimuat untuk mengatur status awal tombol
            // Panggil fetchAndDisableBookedSlots untuk hari default (misalnya, hari ini atau hari pertama yang tersedia)
            // Anda mungkin perlu menentukan hari default atau memicu klik pada tombol hari pertama
            if (dayButtons.length > 0) {
                dayButtons[0].click(); // Simulate click on the first day button to load initial slots
            }
        });
    </script>

</body>
</html>
